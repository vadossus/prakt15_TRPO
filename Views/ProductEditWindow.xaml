<Window x:Class="prakt15_TRPO.Views.ProductEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:prakt15_TRPO" 
        Title="Редактирование товара" Height="621" Width="527" 
        WindowStartupLocation="CenterOwner" Background="{DynamicResource MaterialDesignPaper}">

    <Grid Margin="20">
        <StackPanel>
            <StackPanel Background="{StaticResource PrimaryAccent}">
                <TextBlock Text="Данные товара" FontSize="18" Margin="0,0,0,15" HorizontalAlignment="Center" Foreground="White"/>
            </StackPanel>

            <TextBox materialDesign:HintAssist.Hint="Название товара" x:Name="NameBox" 
                     Style="{StaticResource MaterialDesignFloatingHintTextBox}" Margin="0,5">
                <TextBox.Text>
                    <Binding Path="Name" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged">
                        <Binding.ValidationRules>
                            <local:ValidRule/>
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>

            <TextBox materialDesign:HintAssist.Hint="Описание" 
                     TextWrapping="Wrap" 
                     AcceptsReturn="True" 
                     Height="80"
                     x:Name="DescBox"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}" 
                     Margin="0,15">
                <TextBox.Text>
                    <Binding Path="Description" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" NotifyOnValidationError="True">
                        <Binding.ValidationRules>
                            <local:ValidRule/>
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>

            <UniformGrid Columns="3">
                <TextBox materialDesign:HintAssist.Hint="Цена" 
                    Style="{StaticResource MaterialDesignFloatingHintTextBox}" Margin="0,5,5,5" x:Name="PriceBox">
                    <TextBox.Text>
                        <Binding Path="Price" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" StringFormat="{}{0:N2}">
                            <Binding.ValidationRules>
                                <local:ValidRule/>
                                <local:ValidRuleSymbols/>
                            </Binding.ValidationRules>
                        </Binding>
                    </TextBox.Text>
                </TextBox>

                <TextBox materialDesign:HintAssist.Hint="Рейтинг" 
                     Style="{StaticResource MaterialDesignFloatingHintTextBox}" Margin="5,5,5,5" x:Name="RatingBox">
                    <TextBox.Text>
                        <Binding Path="Rating" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" StringFormat="{}{0:F1}">
                            <Binding.ValidationRules>
                                <local:ValidRule/>
                                <local:ValidRuleSymbols/>
                                <local:ValidRuleRating Min="0" Max="5.0"/>
                            </Binding.ValidationRules>
                        </Binding>
                    </TextBox.Text>
                </TextBox>

                <TextBox materialDesign:HintAssist.Hint="Остаток" 
                    Style="{StaticResource MaterialDesignFloatingHintTextBox}" Margin="5,5,0,5" x:Name="StockBox">
                    <TextBox.Text>
                        <Binding Path="Stock" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged">
                            <Binding.ValidationRules>
                                <local:ValidRule/>
                                <local:ValidRuleSymbols/>
                            </Binding.ValidationRules>
                        </Binding>
                    </TextBox.Text>
                </TextBox>
            </UniformGrid>

            <ComboBox x:Name="CategoryCombo" 
                      materialDesign:HintAssist.Hint="Категория"
                      ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=Categories}"
                      DisplayMemberPath="Name" SelectedValuePath="Id"
                      SelectedValue="{Binding CategoryId}"
                      Style="{StaticResource MaterialDesignFloatingHintComboBox}" Margin="0,10"/>

            <ComboBox x:Name="BrandCombo" 
                      materialDesign:HintAssist.Hint="Бренд"
                      ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=Brands}"
                      DisplayMemberPath="Name" SelectedValuePath="Id"
                      SelectedValue="{Binding BrandId}"
                      Style="{StaticResource MaterialDesignFloatingHintComboBox}" Margin="0,10"/>

            <TextBlock Text="Теги" FontSize="14" Margin="0,10,0,5" Foreground="#666666"/>
            <ListBox x:Name="TagsListBox" 
                     ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=tags}"
                     SelectionMode="Multiple"
                     Style="{StaticResource MaterialDesignFilterChipPrimaryListBox}">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Name}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>


            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="ОТМЕНА" IsCancel="True" Style="{StaticResource MaterialDesignRaisedButton}" Background="{StaticResource SecondaryAccent}" Margin="0,0,10,0"/>
                <Button Content="СОХРАНИТЬ" Click="Save_Click" Style="{StaticResource MaterialDesignRaisedButton}" Background="{StaticResource PrimaryAccent}"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>